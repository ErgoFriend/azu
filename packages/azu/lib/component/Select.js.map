{"version":3,"sources":["../../src/component/Select.jsx"],"names":["h","Color","Component","require","PropTypes","isEqual","figures","arrRotate","noop","Indicator","isSelected","pointer","propTypes","bool","isRequired","Item","label","string","SelectInput","constructor","props","state","rotateIndex","selectedIndex","handleKeyPress","bind","render","items","indicatorComponent","itemComponent","limit","slicedItems","slice","map","item","index","value","Object","assign","componentDidMount","process","stdin","on","componentWillUnmount","removeListener","componentWillReceiveProps","nextProps","setState","ch","key","focus","onSelect","hasLimit","name","lastIndex","length","atFirstIndex","nextIndex","atLastIndex","array","func","number","defaultProps","module","exports"],"mappings":"AAAA;AACA;AACA;;AACA,MAAM,EAACA,CAAD,EAAIC,KAAJ,EAAWC,SAAX,KAAwBC,QAAQ,KAAR,CAA9B;AACA,MAAMC,YAAYD,QAAQ,YAAR,CAAlB;AACA,MAAME,UAAUF,QAAQ,gBAAR,CAAhB;AACA,MAAMG,UAAUH,QAAQ,SAAR,CAAhB;AACA,MAAMI,YAAYJ,QAAQ,YAAR,CAAlB;;AAEA,MAAMK,OAAO,MAAM,CAAE,CAArB;;AAEA,MAAMC,YAAY,CAAC,EAACC,UAAD,EAAD,KAAkB;AAChC,QAAI,CAACA,UAAL,EAAiB;AACb,eAAO,GAAP;AACH;;AAED,WACI;AAAC,aAAD;AAAA,UAAO,UAAP;AACM,WAAEJ,QAAQK,OAAQ;AADxB,KADJ;AAKH,CAVD;;AAYAF,UAAUG,SAAV,GAAsB;AAClBF,gBAAYN,UAAUS,IAAV,CAAeC;AADT,CAAtB;;AAIA,MAAMC,OAAO,CAAC,EAACL,UAAD,EAAaM,KAAb,EAAD,KACT;AAAC,SAAD;AAAA,MAAO,MAAMN,UAAb;AACKM;AADL,CADJ;;AAMAD,KAAKH,SAAL,GAAiB;AACbF,gBAAYN,UAAUS,IAAV,CAAeC,UADd;AAEbE,WAAOZ,UAAUa,MAAV,CAAiBH;AAFX,CAAjB;;AAKA,MAAMI,WAAN,SAA0BhB,SAA1B,CAAoC;AAChCiB,gBAAYC,KAAZ,EAAmB;AACf,cAAMA,KAAN;;AAEA,aAAKC,KAAL,GAAa;AACTC,yBAAa,CADJ;AAETC,2BAAe;AAFN,SAAb;;AAKA,aAAKC,cAAL,GAAsB,KAAKA,cAAL,CAAoBC,IAApB,CAAyB,IAAzB,CAAtB;AACH;;AAEDC,WAAO,EAACC,KAAD,EAAQC,kBAAR,EAA4BC,aAA5B,EAA2CC,KAA3C,EAAP,EAA0D,EAACR,WAAD,EAAcC,aAAd,EAA1D,EAAwF;AACpF,cAAMQ,cAAc,OAAOD,KAAP,KAAiB,QAAjB,GAA4BvB,UAAUoB,KAAV,EAAiBL,WAAjB,EAA8BU,KAA9B,CAAoC,CAApC,EAAuCF,KAAvC,CAA5B,GAA4EH,KAAhG;;AAEA,eAAOI,YAAYE,GAAZ,CAAgB,CAACC,IAAD,EAAOC,KAAP,KAAiB;AACpC,kBAAMzB,aAAayB,UAAUZ,aAA7B;;AAEA,mBACI;AAAA;AAAA,kBAAK,KAAKW,KAAKE,KAAf;AACKpC,kBAAE4B,kBAAF,EAAsB,EAAClB,UAAD,EAAtB,CADL;AAEKV,kBAAE6B,aAAF,EAAiBQ,OAAOC,MAAP,CAAcJ,IAAd,EAAoB,EAACxB,UAAD,EAApB,CAAjB;AAFL,aADJ;AAMH,SATM,CAAP;AAUH;;AAED6B,wBAAoB;AAChBC,gBAAQC,KAAR,CAAcC,EAAd,CAAiB,UAAjB,EAA6B,KAAKlB,cAAlC;AACH;;AAEDmB,2BAAuB;AACnBH,gBAAQC,KAAR,CAAcG,cAAd,CAA6B,UAA7B,EAAyC,KAAKpB,cAA9C;AACH;;AAEDqB,8BAA0BC,SAA1B,EAAqC;AACjC,YAAI,CAACzC,QAAQ,KAAKe,KAAL,CAAWO,KAAnB,EAA0BmB,UAAUnB,KAApC,CAAL,EAAiD;AAC7C,iBAAKoB,QAAL,CAAc;AACVzB,6BAAa,CADH;AAEVC,+BAAe;AAFL,aAAd;AAIH;AACJ;;AAEDC,mBAAewB,EAAf,EAAmBC,GAAnB,EAAwB;AACpB,cAAM,EAACtB,KAAD,EAAQuB,KAAR,EAAepB,KAAf,EAAsBqB,QAAtB,KAAkC,KAAK/B,KAA7C;AACA,cAAM,EAACE,WAAD,EAAcC,aAAd,KAA+B,KAAKF,KAA1C;AACA,cAAM+B,WAAW,OAAOtB,KAAP,KAAiB,QAAlC;;AAEA,YAAIoB,UAAU,KAAd,EAAqB;AACjB;AACH;;AAED,YAAID,IAAII,IAAJ,KAAa,IAAb,IAAqBJ,IAAII,IAAJ,KAAa,GAAtC,EAA2C;AACvC,kBAAMC,YAAY,CAACF,WAAWtB,KAAX,GAAmBH,MAAM4B,MAA1B,IAAoC,CAAtD;AACA,kBAAMC,eAAejC,kBAAkB,CAAvC;AACA,kBAAMkC,YAAaL,WAAW7B,aAAX,GAA2B+B,SAA9C;;AAEA,iBAAKP,QAAL,CAAc;AACVzB,6BAAakC,eAAelC,cAAc,CAA7B,GAAiCA,WADpC;AAEVC,+BAAeiC,eAAeC,SAAf,GAA2BlC,gBAAgB;AAFhD,aAAd;AAIH;;AAED,YAAI0B,IAAII,IAAJ,KAAa,MAAb,IAAuBJ,IAAII,IAAJ,KAAa,GAAxC,EAA6C;AACzC,kBAAMK,cAAcnC,kBAAkB,CAAC6B,WAAWtB,KAAX,GAAmBH,MAAM4B,MAA1B,IAAoC,CAA1E;AACA,kBAAME,YAAaL,WAAW7B,aAAX,GAA2B,CAA9C;;AAEA,iBAAKwB,QAAL,CAAc;AACVzB,6BAAaoC,cAAcpC,cAAc,CAA5B,GAAgCA,WADnC;AAEVC,+BAAemC,cAAcD,SAAd,GAA0BlC,gBAAgB;AAF/C,aAAd;AAIH;;AAED,YAAI0B,IAAII,IAAJ,KAAa,QAAjB,EAA2B;AACvB,kBAAMtB,cAAcqB,WAAW7C,UAAUoB,KAAV,EAAiBL,WAAjB,EAA8BU,KAA9B,CAAoC,CAApC,EAAuCF,KAAvC,CAAX,GAA2DH,KAA/E;AACAwB,qBAASpB,YAAYR,aAAZ,CAAT;AACH;AACJ;AA9E+B;;AAiFpCL,YAAYN,SAAZ,GAAwB;AACpBe,WAAOvB,UAAUuD,KADG;AAEpBT,WAAO9C,UAAUS,IAFG;AAGpBe,wBAAoBxB,UAAUwD,IAHV;AAIpB/B,mBAAezB,UAAUwD,IAJL;AAKpB9B,WAAO1B,UAAUyD,MALG;AAMpBV,cAAU/C,UAAUwD;AANA,CAAxB;;AASA1C,YAAY4C,YAAZ,GAA2B;AACvBnC,WAAO,EADgB;AAEvBuB,WAAO,IAFgB;AAGvBtB,wBAAoBnB,SAHG;AAIvBoB,mBAAed,IAJQ;AAKvBe,WAAO,IALgB;AAMvBqB,cAAU3C;AANa,CAA3B;;AASAuD,OAAOC,OAAP,GAAiBA,UAAU9C,WAA3B,C,CAAwC;AACxC8C,QAAQvD,SAAR,GAAoBA,SAApB;AACAuD,QAAQjD,IAAR,GAAeA,IAAf","file":"Select.js","sourcesContent":["'use strict';\n// https://github.com/vadimdemedes/ink-select-input\n// Text\nconst {h, Color, Component} = require('ink');\nconst PropTypes = require('prop-types');\nconst isEqual = require('lodash.isequal');\nconst figures = require('figures');\nconst arrRotate = require('arr-rotate');\n\nconst noop = () => {};\n\nconst Indicator = ({isSelected}) => {\n    if (!isSelected) {\n        return ' ';\n    }\n\n    return (\n        <Color blue>\n            {`${figures.pointer} `}\n        </Color>\n    );\n};\n\nIndicator.propTypes = {\n    isSelected: PropTypes.bool.isRequired\n};\n\nconst Item = ({isSelected, label}) => (\n    <Color blue={isSelected}>\n        {label}\n    </Color>\n);\n\nItem.propTypes = {\n    isSelected: PropTypes.bool.isRequired,\n    label: PropTypes.string.isRequired\n};\n\nclass SelectInput extends Component {\n    constructor(props) {\n        super(props);\n\n        this.state = {\n            rotateIndex: 0,\n            selectedIndex: 0\n        };\n\n        this.handleKeyPress = this.handleKeyPress.bind(this);\n    }\n\n    render({items, indicatorComponent, itemComponent, limit}, {rotateIndex, selectedIndex}) {\n        const slicedItems = typeof limit === 'number' ? arrRotate(items, rotateIndex).slice(0, limit) : items;\n\n        return slicedItems.map((item, index) => {\n            const isSelected = index === selectedIndex;\n\n            return (\n                <div key={item.value}>\n                    {h(indicatorComponent, {isSelected})}\n                    {h(itemComponent, Object.assign(item, {isSelected}))}\n                </div>\n            );\n        });\n    }\n\n    componentDidMount() {\n        process.stdin.on('keypress', this.handleKeyPress);\n    }\n\n    componentWillUnmount() {\n        process.stdin.removeListener('keypress', this.handleKeyPress);\n    }\n\n    componentWillReceiveProps(nextProps) {\n        if (!isEqual(this.props.items, nextProps.items)) {\n            this.setState({\n                rotateIndex: 0,\n                selectedIndex: 0\n            });\n        }\n    }\n\n    handleKeyPress(ch, key) {\n        const {items, focus, limit, onSelect} = this.props;\n        const {rotateIndex, selectedIndex} = this.state;\n        const hasLimit = typeof limit === 'number';\n\n        if (focus === false) {\n            return;\n        }\n\n        if (key.name === 'up' || key.name === 'k') {\n            const lastIndex = (hasLimit ? limit : items.length) - 1;\n            const atFirstIndex = selectedIndex === 0;\n            const nextIndex = (hasLimit ? selectedIndex : lastIndex);\n\n            this.setState({\n                rotateIndex: atFirstIndex ? rotateIndex + 1 : rotateIndex,\n                selectedIndex: atFirstIndex ? nextIndex : selectedIndex - 1\n            });\n        }\n\n        if (key.name === 'down' || key.name === 'j') {\n            const atLastIndex = selectedIndex === (hasLimit ? limit : items.length) - 1;\n            const nextIndex = (hasLimit ? selectedIndex : 0);\n\n            this.setState({\n                rotateIndex: atLastIndex ? rotateIndex - 1 : rotateIndex,\n                selectedIndex: atLastIndex ? nextIndex : selectedIndex + 1\n            });\n        }\n\n        if (key.name === 'return') {\n            const slicedItems = hasLimit ? arrRotate(items, rotateIndex).slice(0, limit) : items;\n            onSelect(slicedItems[selectedIndex]);\n        }\n    }\n}\n\nSelectInput.propTypes = {\n    items: PropTypes.array,\n    focus: PropTypes.bool,\n    indicatorComponent: PropTypes.func,\n    itemComponent: PropTypes.func,\n    limit: PropTypes.number,\n    onSelect: PropTypes.func\n};\n\nSelectInput.defaultProps = {\n    items: [],\n    focus: true,\n    indicatorComponent: Indicator,\n    itemComponent: Item,\n    limit: null,\n    onSelect: noop\n};\n\nmodule.exports = exports = SelectInput; // eslint-disable-line no-multi-assign\nexports.Indicator = Indicator;\nexports.Item = Item;\n"]}